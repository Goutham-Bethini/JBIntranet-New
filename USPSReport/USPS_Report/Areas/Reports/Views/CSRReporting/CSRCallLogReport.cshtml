@model USPS_Report.Areas.Reports.Models.callLogReportVM
@using Kendo.Mvc.UI
@{
    ViewBag.Title = "CSRCallLogReport";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<center>
    <h2> Call Log Reports</h2>
    @using (Html.BeginForm("CSRCallLogReport", "CSRReporting", FormMethod.Post))
    {
        <div class="form-inline">
            <label>Start Date </label>


            @Html.Kendo().DatePicker().Name("startDt").Value(Model.startDt).Format("MM/dd/yyyy")
            <label>End Date </label>
            @Html.Kendo().DatePicker().Name("endDt").Value(Model.endDt).Format("MM/dd/yyyy")
            @*<label>OutCome </label>
                @Html.DropDownListFor(t => t.ComplaintOutcome, new List<SelectListItem>

                   {
                        new SelectListItem { Text = "All" , Value = "0"},
                        new SelectListItem { Text = "Handled Concern" , Value = "1"},
                         new SelectListItem { Text = "Not Resolved Transferred to Team Lead" , Value = "2"},

                   })*@

            <button id="test" class="btn btn-primary btn-large" type="submit" style="background-color:black">Create Report</button>
        </div>

    }
</center>

<center>

    @if (Model != null && Model.records != null)
    {
        <div class="row">

            <div>
                <div class=" row">
                    <h3 style="color:blue">
                        Total Count =  @Model.records.Count()
                    </h3>
                </div>
                <hr />
                <div class="table-responsive" style="width:95%; align-content:center">
                    <table data-sortable class="table table-hover table-striped table-bordered" style="width:95%; align-content:center">
                        <thead>
                            <tr>
                                <th>Account</th>
                                <th>Ref Num</th>
                                <th>CreatedBy</th>
                                <th>CreatedOn</th>
                                @*<th>Payer</th>*@
                                <th>Primary Payer</th>
                                <th>Secondary Payer</th>
                                <th>Teritiary Payer</th>
                                <th>Complaint Received</th>
                                <th>Issue</th>
                                <th>Product Line</th>
                                <th>Team</th>
                                <th>Complaint Type</th>
                                <th>Resolution</th>
                                <th>Note</th>
                                <th>Issue Date</th>
                                <th>Complaint Date</th>
                                <th>Resolution Date</th>
                                <th>Complaint Attachment</th>
                                <th>Resolution Note</th>
                                <th>Pending Resolution</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var rec in Model.records)
                            {
                            <tr>
                                <td>@rec.account</td>
                                <td>@rec.ReferenceNumber</td>
                                <td>@rec.CreatedBy</td>
                                @*<td>@rec.CreatedOn</td>*@
                                <td>@String.Format("{0:MM/dd/yyyy}", @rec.CreatedOn)</td>
                                @*<td>@rec.Payer</td>*@
                                <td>@rec.PrimaryPayer</td>
                                <td>@rec.SecondaryPayer</td>
                                <td>@rec.TeritiaryPayer</td>
                                <td>@rec.ComplaintRecieved</td>
                                <td>@rec.Issue</td>
                                <td>@rec.ProductLine</td>
                                <td>@rec.Team</td>
                                <td>@rec.ComplaintType</td>
                                <td>@rec.Resolution</td>
                                <td>@rec.Note</td>
                                @*<td><div class="divcls" id="notediv" style="height:50px;overflow:hidden;">@rec.Note <br /></div><a class="readcls" id="more" href="#/">Read more </a></td>*@
                                <td>@String.Format("{0:MM/dd/yyyy}", @rec.IssueDate)</td>
                                <td>@String.Format("{0:MM/dd/yyyy}", @rec.ComplaintDate)</td>
                                <td>@String.Format("{0:MM/dd/yyyy}", @rec.ResolutionDate)</td>
                                @*<td>@rec.IssueDate</td>
        <td>@rec.ComplaintDate</td>
        <td>@rec.ResolutionDate</td>*@
                                @*<td>@rec.IssueDate!=null?@rec.IssueDate.Value.Date:null</td>
        <td>@rec.ComplaintDate!=null?@rec.ComplaintDate.Value.Date:null</td>
        <td>@rec.ResolutionDate!=null?@rec.ResolutionDate.Value.Date:null</td>*@
                                <td><a href="#" class="filedownload">@rec.ComplaintAttachment</a></td>
                                @*<td>@rec.ComplaintAttachment</td>*@
                                <td>@rec.ResolutionNote</td>
                                <td>@rec.PendingResolution</td>
                            </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    }
</center>
<style>
    th {
        background-color: dodgerblue;
        color: white;
    }

    .middle {
        margin: auto;
        width: 900px;
    }
</style>


<script>
    //$('#more2').click(function (e) {
    //    //alert($(this).closest('td').find('.divcls').text());
    //    //alert('hi');
    //    //alert($(this).closest('div'));
    //    //alert(this);
    //    $(this).closest('td').find('.divcls').css({
    //        'height': ''
    //    })
    //    //$("a.active").parents('div').css({ 'height': 'auto' });

    //    //$('#notediv') > $('#more').css({
    //    //    'height': 'auto'
    //    //})
    //    //$('#test').css({
    //    //    'color': 'red'
    //    //})
    //    //$('#more') > $('div').css({
    //    //    'height': 'auto'
    //    //})
    //    //$('div').css({
    //    //    'height': 'auto'
    //    //})
    //    //alert('HI');
    //    //$(this).siblings("#notediv").css({

    //    //    'height': 'auto'
    //    //});
    //    ////e.stopPropagation();
    //    //$('#notediv').css({
            
    //    //    'height': 'auto'
    //    //})
    //});
    //$('#more').click(function () {
    //    alert($(this).closest('td').find('.divcls').text());
    //    //$(this).closest('td').find('.divcls').height(null);
    //    $(this).closest('td').find('.divcls').css({
    //        'color': 'red'
    //    })
    //    //$(document).find('#test').height(50);
    //});

    //$(document).click(function () {
    //    $('div').css({
    //        'height': '50px'
    //    })
    //})

       $(".filedownload").on('click', function () {
              //console.log("text :"+$(this).text());
               var FileName = $(this).text();
               //console.log("File Name " + FileName);
                var urllink = '@Url.Action("Download", "CSRReporting", new {FileName = "-1"})';
                 urllink = urllink.replace("-1", FileName);
                 window.location.href = urllink;
              });
</script>



